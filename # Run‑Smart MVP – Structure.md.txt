# Runâ€‘Smart MVP â€“ **Structure.md**

> Singleâ€‘file reference of everything required to build & ship the public MVP (SprintsÂ 0â€‘10).

---

## 1. Objective

Deliver a 5â€‘screen mobile MVP that helps rookies form a running habit, showcases adaptive AI coaching, and hits **â‰¥40â€¯% D30 retention** & **â‰¥55â€¯% weekly planâ€‘completion**.

## 2. Success Metrics

| Metric                       | Target |
| ---------------------------- | ------ |
| Weekly Planâ€‘Completion       | 55â€¯%   |
| Dayâ€‘30 Retention             | 40â€¯%   |
| Paywall Conversion (flagged) | â‰¥6â€¯%   |

## 3. MVP Scope (In vs. Out)

### Inâ€‘Scope

* 14â€‘Day Adaptive Plan (nightly recalculation)
* AI Chat Coach (OpenAI GPTâ€‘4o driver)
* Route Explorer (GPS/PostGIS)
* Habit Builder Toolkit (calendar sync, reminders)
* Metrics Dashboard (distance, pace, fatigue)
* 5 core screens (see Â§4)
* AWS backend (NestJS) + bare React Native app
* GDPR & USâ€‘CHD compliance (delete/export flows)

### Outâ€‘ofâ€‘Scope / Flags

| Feature        | Flag               | Default  |
| -------------- | ------------------ | -------- |
| Stripe Paywall | `payments_enabled` | false    |
| BLE HR Strap   | `ble_pairing`      | false    |
| Local LLM      | `local_llm`        | false    |
| Social Feed    | â€”                  | deferred |

## 4. Screen Blueprint

| # | Route      | Purpose           | Key Elements                                                                        |
| - | ---------- | ----------------- | ----------------------------------------------------------------------------------- |
| 1 | `/today`   | Today Dashboard   | Calendar strip, weather chip, workout/rest card, **Record** & **Add Activity** FABs |
| 2 | `/plan`    | Plan Overview     | Status rings, week accordions, coachâ€‘tip banner                                     |
| 3 | `/record`  | Record Run        | Map, lap metrics, timer, voice cues, pause/stop bar                                 |
| 4 | `/chat`    | AI Coach Chat     | Thread UI, prompt chips, feedback icons                                             |
| 5 | `/onboard` | Runner Onboarding | 5â€‘step wizard incl. 21â€‘Day Rookie Challenge                                         |

## 5. Core Epics â†’ Stories

```
E-ACC  Account & Profile
  ACCâ€‘001  Email signâ€‘up w/ Cognito (3 pts)
  ACCâ€‘002  OAuth (Apple, Google) (5 pts)
E-PGN  Plan Generation
  PGNâ€‘001  Seed 14â€‘day plan (5)
  PGNâ€‘002  Nightly recalculation (8)
E-RUN  Run Logging
  RUNâ€‘001  Start/Stop GPS session (8)
  RUNâ€‘002  Autoâ€‘pause & lap split (5)
E-ADA  Adaptive Coaching
  ADAâ€‘001  Postâ€‘run adjust (8)
E-CHAT  Chat Coach
  CHATâ€‘001  GPT chat (5)
  CHATâ€‘002  Suggested chips (3)
E-ROUTE  Route Explorer
  ROUTEâ€‘001  Flat 5â€¯km search (8)
E-HABIT  Habit Builder
  HABâ€‘001  Calendar reminders (3)
INFRA  CDK & CI
  INFâ€‘001Â  Preview stack (5)
  INFâ€‘002Â  Expo EAS pipeline (3)
```

*Total initial backlog â‰ˆÂ 70 pts.*

## 6. Tech Stack Snapshot

| Layer     | Tech                                           |
| --------- | ---------------------------------------------- |
| Mobile    | Bare React Native + Expo EAS                   |
| Backend   | NestJS monorepo, GraphQL gateway               |
| DB        | PostgresÂ 16 + PostGIS + PGVector               |
| AI        | OpenAI GPTâ€‘4o via common `ChatDriver`          |
| Infra     | AWS CDK â†’ AppÂ Runner, Cognito, S3, BullMQ jobs |
| Analytics | **PostHog** cloud (EU cluster)                 |

## 7. Nonâ€‘Functional Targets

* Cold startÂ <Â 1.5â€¯s, API p95Â <Â 400â€¯ms
* UptimeÂ 99.9â€¯% (blue/green deploys)
* Rowâ€‘level encryption for health data, OAuth + JWT auth

## 8. Timeline (10 Sprints)

| Sprint | Highlight                             |
| ------ | ------------------------------------- |
| 0      | Repo, CI/CD, preview stack            |
| 1      | Onboarding wizard + Auth svc          |
| 2      | Today Dashboard + Plan seed API       |
| 3      | Record Run + Run logging svc          |
| 4      | Plan recalculation & dashboard wiring |
| 5      | Chat Coach live                       |
| 6      | Plan Overview & metrics agg           |
| 7      | Route Explorer beta                   |
| 8      | GDPR flows, a11y polish               |
| 9      | Private beta, release checklist       |
| 10     | Public launch ðŸš€                      |

## 9. Risks & Mitigations

| Risk            | Mitigation                             |
| --------------- | -------------------------------------- |
| LLM cost spikes | Token budgeting, local Llamaâ€‘3 StageÂ 3 |
| GPS variance    | Path smoothing + minâ€‘distance filter   |
| Store rejection | Clear consent & privacy labels         |

## 10. Team & Cadence

| Role           | Capacity / Sprint |
| -------------- | ----------------- |
| FrontendÂ Ã—2    | 12 pts            |
| BackendÂ Ã—2     | 10 pts            |
| DevOps         | 2 pts             |
| QA (partâ€‘time) | 2 pts             |

* **Standâ€‘up:** 09:30 Asia/Jerusalem (daily)
* **Grooming:** Wed 45Â min
* **Review/Retro:** Fri endâ€‘ofâ€‘sprint

## 11. PostHog Event Schema (abbr.)

| Event                  | Props                                    |
| ---------------------- | ---------------------------------------- |
| `run_started`          | `planId`, `workoutType`                  |
| `run_completed`        | `distance`, `duration`, `avgPace`, `rpe` |
| `chat_question`        | `tokensIn`, `topic`                      |
| `plan_completion_rate` | weekly cron, `%complete`                 |

---

*This **Structure.md** is the authoritative birdâ€™sâ€‘eye view for all contributors.*
